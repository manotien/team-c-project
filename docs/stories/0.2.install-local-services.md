# Story 0.2: Install and Configure Local Services

**Epic:** Epic 0 - Project Initialization & Setup
**Story ID:** US-0.2
**Priority:** Critical (P0)
**Estimate:** 1 hour

---

## Status

**Draft**

---

## Story

**As a** developer,
**I want** to install PostgreSQL and Redis locally,
**so that** the application can connect to required backend services.

---

## Acceptance Criteria

1. PostgreSQL 15+ installed locally
2. PostgreSQL service running on port 5432
3. Database `household_bills` created
4. Connection verified: `psql -d household_bills -c "SELECT version();"`
5. Redis 7+ installed locally
6. Redis service running on port 6379
7. Redis connection verified: `redis-cli ping` returns "PONG"
8. Services configured to start automatically (optional but recommended)

---

## Tasks / Subtasks

- [ ] **Task 1: Install PostgreSQL** (AC: 1, 2)
  - [ ] macOS: Run `brew install postgresql@15`
  - [ ] macOS: Start service: `brew services start postgresql@15`
  - [ ] Linux: Run `sudo apt update && sudo apt install postgresql postgresql-contrib`
  - [ ] Linux: Start service: `sudo systemctl start postgresql`
  - [ ] Verify version: `psql --version` (should show 15.x)
  - [ ] Verify service running: Check port 5432 open

- [ ] **Task 2: Create household_bills database** (AC: 3, 4)
  - [ ] macOS: Run `createdb household_bills`
  - [ ] Linux: Run `sudo -u postgres createdb household_bills`
  - [ ] Test connection: `psql -d household_bills -c "SELECT version();"`
  - [ ] Verify database exists: `psql -l | grep household_bills`

- [ ] **Task 3: Install Redis** (AC: 5, 6)
  - [ ] macOS: Run `brew install redis`
  - [ ] macOS: Start service: `brew services start redis`
  - [ ] Linux: Run `sudo apt install redis-server`
  - [ ] Linux: Start service: `sudo systemctl start redis-server`
  - [ ] Verify version: `redis-cli --version` (should show 7.x)

- [ ] **Task 4: Verify Redis connection** (AC: 7)
  - [ ] Run `redis-cli ping` - should return "PONG"
  - [ ] Test SET/GET: `redis-cli SET test "hello"` then `redis-cli GET test`
  - [ ] Verify service running on port 6379: `redis-cli -p 6379 ping`

- [ ] **Task 5: Configure auto-start (optional)** (AC: 8)
  - [ ] macOS: Services already auto-start with `brew services`
  - [ ] Linux PostgreSQL: `sudo systemctl enable postgresql`
  - [ ] Linux Redis: `sudo systemctl enable redis-server`

- [ ] **Task 6: Document service management**
  - [ ] Add to README.md: How to start/stop services
  - [ ] macOS commands: `brew services start/stop postgresql@15`
  - [ ] macOS commands: `brew services start/stop redis`
  - [ ] Linux commands: `sudo systemctl start/stop postgresql`
  - [ ] Linux commands: `sudo systemctl start/stop redis-server`

---

## Dev Notes

### Relevant Architecture Information

**Platform and Infrastructure (from docs/architecture.md):**
- **Platform:** Local Development Environment
- **Database:** PostgreSQL 15+ (localhost:5432)
- **Queue Storage:** Redis 7.2+ (localhost:6379)
- **Local Services:** Direct installation (no Docker)

**Database Configuration:**
- Database name: `household_bills`
- Default port: 5432
- Default user: `postgres` (or current system user on macOS)
- No password required for local development
- Connection URL format: `postgresql://postgres:postgres@localhost:5432/household_bills`

**Redis Configuration:**
- Default port: 6379
- No password required for local development
- Used for Bull queue job storage
- Connection: `redis://localhost:6379`

**Why Local Installation (not Docker):**
- Faster startup and iteration
- No Docker overhead for hackathon
- Direct service access for debugging
- Simpler for team members unfamiliar with Docker

### Platform-Specific Notes

**macOS (Homebrew):**
- Easiest installation path
- Services managed via `brew services`
- Auto-start on boot configured automatically
- PostgreSQL data: `/opt/homebrew/var/postgresql@15/`
- Redis data: `/opt/homebrew/var/db/redis/`

**Linux (Ubuntu/Debian):**
- Use apt package manager
- Services managed via `systemctl`
- May need to configure PostgreSQL authentication (pg_hba.conf)
- PostgreSQL data: `/var/lib/postgresql/15/main/`
- Redis data: `/var/lib/redis/`

**Windows (WSL2):**
- Use Linux installation instructions within WSL
- Services managed via systemctl
- Access from Windows: Connect to `localhost` from WSL

### Troubleshooting Common Issues

**PostgreSQL Issues:**
- Port 5432 already in use: Check for existing PostgreSQL instances
- Permission denied: Ensure user has database creation permissions
- Connection refused: Verify service is running: `pg_isready`

**Redis Issues:**
- Port 6379 already in use: Check for existing Redis instances
- Permission denied: Check Redis service status and logs
- Connection timeout: Verify Redis is bound to localhost (not just 127.0.0.1)

### Testing

**Verification Steps:**
1. PostgreSQL:
   - `psql --version` - Check version
   - `psql -d household_bills -c "SELECT version();"` - Test connection
   - `psql -d household_bills -c "CREATE TABLE test (id INT);"` - Test write
   - `psql -d household_bills -c "DROP TABLE test;"` - Cleanup

2. Redis:
   - `redis-cli --version` - Check version
   - `redis-cli ping` - Test connection
   - `redis-cli SET testkey "testvalue"` - Test write
   - `redis-cli GET testkey` - Test read
   - `redis-cli DEL testkey` - Cleanup

**No automated tests for this story** - Manual verification only

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-03 | 1.0 | Initial story creation | Sarah (PO) |

---

## Dev Agent Record

### Agent Model Used

_To be populated by dev agent_

### Debug Log References

_To be populated by dev agent_

### Completion Notes List

_To be populated by dev agent_

### File List

_To be populated by dev agent_

---

## QA Results

_To be populated by QA agent_
