# Story 8.2: Display Bill Type Icons Across All Lists

**Epic:** EPIC-8 - Profile & Icons
**Story ID:** US-8.2
**Priority:** Low (P3)
**Status:** Draft

---

## Story

**As a** user,
**I want** to see contextual icons for each bill type (‚ö°Electric, üíßWater, üåêInternet, üöóCar, üè†Home),
**so that** I can quickly identify bill categories visually

---

## Acceptance Criteria

1. Bill type icons mapped correctly:
   - ELECTRIC ‚Üí ‚ö° (lightning bolt)
   - WATER ‚Üí üíß (water droplet)
   - INTERNET ‚Üí üåê (globe with meridians)
   - CAR ‚Üí üöó (automobile)
   - HOME ‚Üí üè† (house)
   - OTHER ‚Üí üìÑ (page/document)
2. Icons displayed in:
   - Task cards on dashboard
   - Bill detail pages
   - Task history list
   - Monthly summary breakdowns
   - Add Bill form (type selector)
3. Icon size consistent across app (24px or 1.5rem)
4. Icon positioned consistently (typically left of vendor name)
5. Icon has accessible label (aria-label or title attribute)
6. Icons visible in all screen sizes (responsive)
7. Icon color matches bill type theme (optional: color coding)

---

## Tasks / Subtasks

- [ ] Create bill type icon mapping utility (AC: 1)
  - [ ] Create `lib/utils/billIcons.ts`
  - [ ] Define icon mapping object for all bill types
  - [ ] Export getBillTypeIcon(billType) function
  - [ ] Handle null/undefined bill types (default to OTHER)
  - [ ] Add TypeScript types for BillType enum

- [ ] Create BillTypeIcon component (AC: 1, 3, 5, 7)
  - [ ] Create `components/bills/BillTypeIcon.tsx`
  - [ ] Accept props: type (BillType), size ('sm' | 'md' | 'lg')
  - [ ] Use getBillTypeIcon utility for icon lookup
  - [ ] Implement size variants (sm: 16px, md: 24px, lg: 32px)
  - [ ] Add aria-label for accessibility
  - [ ] Add optional color coding per bill type
  - [ ] Export component for reuse

- [ ] Integrate icons in Task cards (AC: 2a, 4)
  - [ ] Update TaskCard component
  - [ ] Import BillTypeIcon component
  - [ ] Position icon left of vendor name
  - [ ] Use 'md' size (24px)
  - [ ] Ensure consistent layout with text

- [ ] Integrate icons in Bill detail pages (AC: 2b, 4)
  - [ ] Update Bill detail component
  - [ ] Add BillTypeIcon to bill header
  - [ ] Position icon with vendor name
  - [ ] Use 'lg' size (32px) for emphasis

- [ ] Integrate icons in Task history list (AC: 2c, 4)
  - [ ] Update TaskHistory/TaskList component
  - [ ] Add BillTypeIcon to each task row
  - [ ] Position icon left of task description
  - [ ] Use 'sm' or 'md' size (16-24px)

- [ ] Integrate icons in Monthly summary (AC: 2d)
  - [ ] Update Monthly Summary component (Epic 6)
  - [ ] Add BillTypeIcon to breakdown items
  - [ ] Show icon next to each bill type category
  - [ ] Use 'md' size (24px)

- [ ] Integrate icons in Add Bill form (AC: 2e)
  - [ ] Update Add Bill form component (Epic 1)
  - [ ] Add icons to bill type dropdown options
  - [ ] Show icon next to each type label
  - [ ] Display selected icon in input field
  - [ ] Use 'sm' size (16px) in dropdown

- [ ] Ensure responsive design (AC: 6)
  - [ ] Test icons on mobile (320px width)
  - [ ] Test icons on tablet (768px width)
  - [ ] Test icons on desktop (1024px+ width)
  - [ ] Ensure icons don't wrap or overflow
  - [ ] Maintain consistent spacing

- [ ] Add optional color coding (AC: 7)
  - [ ] Define color scheme per bill type
  - [ ] Apply colors via CSS classes
  - [ ] Ensure WCAG AA color contrast
  - [ ] Make color coding configurable (on/off)

---

## Dev Notes

### Technical Context

**Tech Stack:**
- Icons: Unicode emoji (simple, cross-platform)
- Alternative: Lucide React icons (SVG, more consistent)
- Styling: Tailwind CSS for sizing and colors
- TypeScript: Strict typing for BillType enum

**Integration Points:**
- Epic 1 (US-1.3): Add Bill form type selector
- Epic 2: Task cards on dashboard
- Epic 3: Task detail pages
- Epic 4: Task history list
- Epic 6: Monthly summary breakdowns
- All epics that display bills or tasks

**Key Implementation Details:**

**Bill Type Icon Utility (`lib/utils/billIcons.ts`):**
```typescript
export enum BillType {
  ELECTRIC = 'ELECTRIC',
  WATER = 'WATER',
  INTERNET = 'INTERNET',
  CAR = 'CAR',
  HOME = 'HOME',
  OTHER = 'OTHER'
}

const BILL_ICONS = {
  ELECTRIC: '‚ö°',
  WATER: 'üíß',
  INTERNET: 'üåê',
  CAR: 'üöó',
  HOME: 'üè†',
  OTHER: 'üìÑ'
} as const;

const BILL_COLORS = {
  ELECTRIC: 'text-yellow-500',
  WATER: 'text-blue-500',
  INTERNET: 'text-purple-500',
  CAR: 'text-red-500',
  HOME: 'text-green-500',
  OTHER: 'text-gray-500'
} as const;

export function getBillTypeIcon(billType?: BillType | null): string {
  if (!billType) return BILL_ICONS.OTHER;
  return BILL_ICONS[billType] || BILL_ICONS.OTHER;
}

export function getBillTypeColor(billType?: BillType | null): string {
  if (!billType) return BILL_COLORS.OTHER;
  return BILL_COLORS[billType] || BILL_COLORS.OTHER;
}

export function getBillTypeLabel(billType?: BillType | null): string {
  if (!billType) return 'Other';
  return billType.charAt(0) + billType.slice(1).toLowerCase();
}
```

**BillTypeIcon Component (`components/bills/BillTypeIcon.tsx`):**
```typescript
import { BillType, getBillTypeIcon, getBillTypeColor, getBillTypeLabel } from '@/lib/utils/billIcons';

interface BillTypeIconProps {
  type?: BillType | null;
  size?: 'sm' | 'md' | 'lg';
  showColor?: boolean;
  className?: string;
}

export function BillTypeIcon({
  type,
  size = 'md',
  showColor = true,
  className = ''
}: BillTypeIconProps) {
  const icon = getBillTypeIcon(type);
  const colorClass = showColor ? getBillTypeColor(type) : '';
  const label = getBillTypeLabel(type);

  const sizeClasses = {
    sm: 'text-base',      // 16px
    md: 'text-xl',        // 24px
    lg: 'text-2xl'        // 32px
  };

  return (
    <span
      className={`inline-flex items-center justify-center ${sizeClasses[size]} ${colorClass} ${className}`}
      role="img"
      aria-label={`${label} bill icon`}
      title={label}
    >
      {icon}
    </span>
  );
}
```

**Usage in Task Card:**
```typescript
import { BillTypeIcon } from '@/components/bills/BillTypeIcon';

export function TaskCard({ task }: { task: Task }) {
  return (
    <div className="flex items-center gap-3 p-4 border rounded">
      <BillTypeIcon type={task.bill.billType} size="md" />
      <div>
        <h3>{task.bill.vendor || 'Bill Payment'}</h3>
        <p>{task.bill.amount} THB</p>
      </div>
    </div>
  );
}
```

**Usage in Add Bill Form (Dropdown):**
```typescript
import { BillType, getBillTypeIcon, getBillTypeLabel } from '@/lib/utils/billIcons';

const billTypes = Object.values(BillType);

<select name="billType">
  {billTypes.map(type => (
    <option key={type} value={type}>
      {getBillTypeIcon(type)} {getBillTypeLabel(type)}
    </option>
  ))}
</select>

// Or with custom dropdown component:
<Dropdown>
  {billTypes.map(type => (
    <DropdownItem key={type} value={type}>
      <BillTypeIcon type={type} size="sm" />
      <span className="ml-2">{getBillTypeLabel(type)}</span>
    </DropdownItem>
  ))}
</Dropdown>
```

**Usage in Monthly Summary:**
```typescript
<div className="space-y-2">
  {billsByType.map(({ type, total, count }) => (
    <div key={type} className="flex items-center justify-between">
      <div className="flex items-center gap-2">
        <BillTypeIcon type={type} size="md" />
        <span>{getBillTypeLabel(type)}</span>
        <span className="text-muted-foreground">({count})</span>
      </div>
      <span className="font-semibold">{total} THB</span>
    </div>
  ))}
</div>
```

**Alternative: Lucide React Icons (SVG)**

If emoji rendering is inconsistent across devices:

```typescript
import { Zap, Droplet, Globe, Car, Home, FileText } from 'lucide-react';

const BILL_ICONS = {
  ELECTRIC: Zap,
  WATER: Droplet,
  INTERNET: Globe,
  CAR: Car,
  HOME: Home,
  OTHER: FileText
} as const;

export function BillTypeIcon({ type, size = 24 }: BillTypeIconProps) {
  const Icon = BILL_ICONS[type || 'OTHER'];
  return <Icon size={size} aria-label={`${type} bill icon`} />;
}
```

**Accessibility:**
- `role="img"` on emoji spans
- `aria-label` with descriptive text (e.g., "Electric bill icon")
- `title` attribute for tooltip on hover
- Sufficient color contrast if using color coding (WCAG AA: 4.5:1)

**Responsive Design:**
- Icons scale with text size (em/rem units)
- Flexible layout prevents overflow
- Consistent spacing across screen sizes

### Testing

**Test Location:** `__tests__/lib/utils/billIcons.test.ts` and `__tests__/components/bills/BillTypeIcon.test.tsx`

**Testing Standards:**
- Unit tests for utility functions
- Unit tests for BillTypeIcon component
- Visual regression tests for icon display
- Accessibility tests (WCAG AA)
- Cross-browser testing for emoji rendering

**Testing Frameworks:**
- Jest for unit tests
- React Testing Library for component tests
- Axe for accessibility testing
- Percy/Chromatic for visual regression (optional)
- Playwright for cross-browser testing

**Specific Requirements:**
- Test getBillTypeIcon returns correct emoji for each type
- Test getBillTypeIcon handles null/undefined (returns OTHER)
- Test getBillTypeColor returns correct Tailwind class
- Test getBillTypeLabel formats label correctly
- Test BillTypeIcon renders with correct size
- Test BillTypeIcon renders with correct icon
- Test BillTypeIcon has aria-label
- Test BillTypeIcon has title attribute
- Test BillTypeIcon shows color when showColor=true
- Test BillTypeIcon no color when showColor=false
- Test icon display in TaskCard
- Test icon display in Bill detail page
- Test icon display in Task history
- Test icon display in Monthly summary
- Test icon display in Add Bill form dropdown
- Test responsive design on mobile/tablet/desktop
- Test emoji rendering on iOS, Android, Windows, macOS
- Test accessibility with screen reader
- Test keyboard navigation

**Test Scenarios:**
1. **All bill types**: Verify each type shows correct icon
2. **Null/undefined type**: Shows OTHER icon (üìÑ)
3. **Icon sizes**: sm (16px), md (24px), lg (32px) render correctly
4. **Color coding**: Each type shows correct color
5. **Accessibility**: aria-label and title present
6. **Responsive**: Icons don't overflow on small screens
7. **Integration**: Icons display correctly in all components
8. **Cross-browser**: Emoji consistent across browsers (or use SVG fallback)

**Known Issues/Considerations:**
- Emoji rendering varies by OS (iOS vs Android vs Windows)
- Consider Lucide React if emoji inconsistency is problematic
- Test with real devices, not just browser DevTools

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-03 | 1.0 | Initial story creation from Epic 8 | Sarah (PO) |

---

## Dev Agent Record

### Agent Model Used

_To be populated by dev agent_

### Debug Log References

_To be populated by dev agent_

### Completion Notes List

_To be populated by dev agent_

### File List

_To be populated by dev agent_

---

## QA Results

_To be populated by QA agent_
